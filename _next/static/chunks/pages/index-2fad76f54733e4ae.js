(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6111:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(4938)),i=n(5893),l=(0,a.default)((0,i.jsx)("path",{d:"m12 21.35-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"}),"Favorite");t.Z=l},1811:function(e,t,n){"use strict";var r=n(4836);t.Z=void 0;var a=r(n(4938)),i=n(5893),l=(0,a.default)((0,i.jsx)("path",{d:"M16.5 3c-1.74 0-3.41.81-4.5 2.09C10.91 3.81 9.24 3 7.5 3 4.42 3 2 5.42 2 8.5c0 3.78 3.4 6.86 8.55 11.54L12 21.35l1.45-1.32C18.6 15.36 22 12.28 22 8.5 22 5.42 19.58 3 16.5 3zm-4.4 15.55-.1.1-.1-.1C7.14 14.24 4 11.39 4 8.5 4 6.5 5.5 5 7.5 5c1.54 0 3.04.99 3.57 2.36h1.87C13.46 5.99 14.96 5 16.5 5c2 0 3.5 1.5 3.5 3.5 0 2.89-3.14 5.74-7.9 10.05z"}),"FavoriteBorder");t.Z=l},8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(1150)}])},1150:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r=n(5893),a=n(7294),i=n(9837),l=n(1359),o=n(5493),s=n(1953),d=n(4373),u=n(9144),c=n(562),m=n(1160),h=n(1811),x=n(6111),p=n(1350),v=n(2521),g=n(709),w=n(952),f=n(9321);let j=e=>{let t=document.createElement("a");t.download="filename.png",t.href=e.toDataURL("image/png"),t.click()},Z=async(e,t)=>{let n=e.getContext("2d"),r=t.outerHTML,a="data:image/svg+xml,"+"<svg xmlns='http://www.w3.org/2000/svg' width='".concat(e.width,"' height='").concat(e.height,"'>")+"<foreignObject width='100%' height='100%'><div xmlns='http://www.w3.org/1999/xhtml'>"+r+"</div></foreignObject></svg>",i=document.createElement("div");i.innerHTML=a;let l=new Image;l.src=a,await new Promise(e=>{l.onload=function(){n.setTransform(2,0,0,2,0,0),n.drawImage(l,+t.parentElement.style.left.replace("px",""),+t.parentElement.style.top.replace("px","")),n.setTransform(1,0,0,1,0,0),i.remove(),e()}})},C=async(e,t)=>{let n=e.getContext("2d");n.clearRect(0,0,e.width,e.height);let r=new Image;return r.crossOrigin="anonymous",r.src=t,await new Promise(t=>{r.addEventListener("load",()=>{let a=r.width/f.v/2;e.height=r.height/a,e.width=r.width/a,n.drawImage(r,0,0,r.width/a,r.height/a),t(e)})}),e};var E={download:j,drawHTMLElementOnCanvas:Z,drawImageOnCanvas:C};let y=async(e,t)=>{let n=document.createElement("canvas");for(let r of(await E.drawImageOnCanvas(n,e.url),t))await E.drawHTMLElementOnCanvas(n,r);return n};function I(e){let{template:t}=e,{user:n}=(0,a.useContext)(v.I),[i,l]=(0,a.useState)([]),[o]=(0,m.d4)(m.vb.GET_FAVOURITES,{userId:null==n?void 0:n.id}),[f,{isLoading:j}]=(0,p.ZY)(),[Z,{isLoading:C}]=(0,p.Zx)(),[I,{isLoading:T}]=(0,p.Xt)(),_=()=>{f({userId:n.id,templateId:t.id})},b=()=>{Z({userId:n.id,templateId:t.id})},k=async()=>{let e=document.querySelectorAll(".editable-text"),r=await y(t,e);n&&await I({userId:n.id,templateId:t.id,image:r.toDataURL()}),E.download(r)};return(0,r.jsxs)(s.Z,{sx:{width:"100%"},children:[(0,r.jsx)(d.Z,{sx:{mb:2}}),t&&(0,r.jsx)(s.Z,{children:(0,r.jsxs)(u.Z,{direction:"row",gap:4,children:[(0,r.jsx)(g.Z,{template:t,texts:i,onChange:l}),(0,r.jsxs)(u.Z,{flexGrow:1,justifyContent:"flex-start",children:[(0,r.jsx)(s.Z,{sx:{margin:"20px auto"},children:(0,r.jsx)(w.Z,{size:"large",variant:"contained",onClick:k,loader:T,children:"Generate"})}),n&&(0,r.jsx)(u.Z,{direction:"row",marginTop:"auto",justifyContent:"flex-end",children:o.find(e=>e.id===t.id)?(0,r.jsx)(c.Z,{disabled:C,color:"error",onClick:b,children:(0,r.jsx)(x.Z,{})}):(0,r.jsx)(c.Z,{disabled:j,color:"error",onClick:()=>_(),children:(0,r.jsx)(h.Z,{})})})]})]})})]})}let T=e=>{let{templates:t,handleTemplateClick:n}=e;return(0,r.jsx)(u.Z,{gap:2,direction:"row",height:96,overflow:"auto",sx:{py:2,px:1},children:null==t?void 0:t.map(e=>(0,r.jsx)(s.Z,{sx:{cursor:"pointer",transition:"all 150ms",":hover":{transform:"scale(1.1)"}},onClick:()=>n(e),children:(0,r.jsx)("img",{src:e.url,alt:"meme",style:{height:64}})},e.id))})},_=e=>{let{handleTemplateClick:t}=e,{user:n}=(0,a.useContext)(v.I),[i]=(0,m.d4)(m.vb.GET_FAVOURITES,{userId:null==n?void 0:n.id});return(0,r.jsx)(T,{templates:i,handleTemplateClick:t})};var b=n(3053);function k(e){let{handleTemplateClick:t}=e,[n]=(0,m.d4)(m.vb.GET_TEMPLATES,{status:b.K.PUBLISHED});return(0,r.jsx)(T,{templates:n,handleTemplateClick:t})}let L=()=>{let{user:e}=(0,a.useContext)(v.I),[t]=(0,m.d4)(m.vb.GET_USER_MEMES,{userId:null==e?void 0:e.id});return(0,r.jsx)(u.Z,{gap:2,direction:"row",overflow:"auto",sx:{py:2},children:null==t?void 0:t.map(e=>(0,r.jsx)(s.Z,{sx:{cursor:"pointer"},children:(0,r.jsx)("img",{src:e.url,alt:"meme",style:{maxHeight:128}})},e.id))})};function O(){let[e,t]=(0,a.useState)(null),n=e=>{t(e)};return(0,r.jsx)(i.Z,{children:(0,r.jsxs)(l.Z,{children:[(0,r.jsx)(o.Z,{items:[{label:"Popular",render:()=>(0,r.jsx)(k,{handleTemplateClick:n})},{label:"Favourites",render:()=>(0,r.jsx)(_,{handleTemplateClick:n})},{label:"My memes",render:()=>(0,r.jsx)(L,{})}]}),(0,r.jsx)(I,{template:e})]})})}},1350:function(e,t,n){"use strict";n.d(t,{C0:function(){return s},OE:function(){return i},Xt:function(){return d},ZY:function(){return l},Zx:function(){return o}});var r=n(6678);let a=r.h.injectEndpoints({endpoints:e=>({signUp:e.mutation({query(e){let{email:t,password:n}=e;return{url:"/auth/signUp",method:"post",data:{email:t,password:n}}}}),addFavourite:e.mutation({query(e){let{userId:t,templateId:n}=e;return{url:"/users/".concat(t,"/favourites"),method:"post",data:{templateId:n}}}}),removeFavourite:e.mutation({query(e){let{userId:t,templateId:n}=e;return{url:"/users/".concat(t,"/favourites/").concat(n),method:"delete"}}}),updateAvatar:e.mutation({query(e){let{userId:t,image:n}=e;return{url:"/users/".concat(t,"/avatar"),method:"put",data:{image:n}}}}),addMeme:e.mutation({query(e){let{userId:t,templateId:n,image:r}=e;return{url:"/users/".concat(t,"/memes"),method:"post",data:{image:r,templateId:n}}}})}),overrideExisting:!1}),{useSignUpMutation:i,useAddFavouriteMutation:l,useRemoveFavouriteMutation:o,useUpdateAvatarMutation:s,useAddMemeMutation:d}=a}},function(e){e.O(0,[269,866,268,406,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);